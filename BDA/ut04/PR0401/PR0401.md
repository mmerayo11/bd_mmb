# PR0401: MapReduce (I)

## Ejercicio 1: Contando palabras

### mapper
```
import sys
import string

traductor = str.maketrans('', '', string.punctuation)

for line in sys.stdin:
    line = line.strip()
    words = line.split()
    
    for word in words:
        word = word.translate(traductor)
        word = word.lower()
        print(f"{word}\t1")
```

### reducer, que sera siempre el mismo
```
import sys

current_word = None
current_count = 0
word = None

for line in sys.stdin:
    line = line.strip()
    try: 
        word, count = line.split('\t', 1)
        count = int(count)
    except ValueError:
        continue

    if current_word == word:
        current_count += count
    else:
        if current_word:
            print(f"{current_word}\t{current_count}")
        current_word = word
        current_count = count

if current_count:
    print(f"{current_word}, {current_count}")
```

### Salida

```
!cat "quijote.txt" \
| python3 pymapper.py \
| sort \
| python3 pyreducer.py
```

## Ejercicio 2: Filtrado de palabras representativas

### mapper2
```
import sys
import string
palabrasNoSignificaticas = [
    "a", "ante", "bajo", "con", "contra", "de", "desde", "en", "entre", "hacia", "hasta", "para", "por", "según", "sin", "sobre", "tras", "y", "e", "ni", "o", "u", "pero", "porque", "aunque",  "si",         "que", "el", "la", "los", "las", "un", "una", "unos", "unas", "este", "esta", "estos", "estas", "ese", "esa", "esos",
    "esas", "aquel", "aquella", "aquellos", "aquellas", "mi", "tu", "su", "mis",
    "tus", "sus", "nuestro", "nuestra", "nuestros", "nuestras", "vuestro", "vuestra", "vuestros", "vuestras", "del", "se"
]

traductor = str.maketrans('', '', string.punctuation)

for line in sys.stdin:
    line = line.strip()
    words = line.split()
    
    for word in words:
        word = word.translate(traductor)
        word = word.lower()

        if word and word not in palabrasNoSignificaticas:
            print(f"{word}\t1")
```

### Salida
```
!cat "quijote.txt" \
| python3 pymapper2.py \
| sort \
| python3 pyreducer.py
```

## Ejercicio 3: Ordenación por frecuencia (Top-N)

### mapper3
```
import sys

for line in sys.stdin:
    line = line.strip()
    
    parts = line.split()
    
    if len(parts) == 2:
        word = parts[0]
        count = parts[1]
        
        try:
            count_padded = f"{int(count):010d}"
            print(f"{count_padded}\t{word}")
        except ValueError:
            continue
```

### Salida 
```
!cat "quijote.txt" \
| python3 pymapper2.py \
| sort \
| python3 pyreducer.py \
| python3 pymapper3.py \
| sort -r
```